import cbpro
from Robinhood import Robinhood
from decouple import config

coinbase_key        = config('CB_API_PKEY')
coinbase_secret     = config('CB_API_SKEY')
coinbase_passphrase = config('CB_PASSPHRASE')
robinhood_username  = config('RH_UN')
robinhood_password  = config('RH_PW')
rh_account_number   = config('RH_AN')
rh_api_url          = 'https://api.robinhood.com/'
rh_account_url      = rh_api_url + 'account/' + rh_account_number

cb_pub_cli  = cbpro.PublicClient()
cb_auth_cli = cbpro.AuthenticatedClient(coinbase_key,
                                      coinbase_secret,
                                      coinbase_passphrase)

""" prompts 2FA input automatically on app start """
rh_client = Robinhood()
rh_client.login(username=robinhood_username, password=robinhood_password)

class CoinbaseClient():
    def account(self):
        return cb_auth_cli.get_accounts()

    def ticker(self, currency):
        return cb_pub_cli.get_product_ticker(product_id=currency)

class RobinhoodClient():
    def __init__(self):
        rh_client
        return None

    def account(self):
        return rh_client.get_account()

    def account_url(self):
        return rh_account_url

    def instruments(self, symb):
        return rh_client.instruments("GEVO")[0]

    def buy(self):
        rh_client.place_market_buy_order(symbol='BTC', time_in_force='GFD', quantity=0.01)

    def build_order(self):
